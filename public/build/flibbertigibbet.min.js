var FacebookButton=React.createClass({displayName:"FacebookButton",handleClick:function(){this.props.onSessionChange()},render:function(){var a=this.props.loggedIn?React.DOM.a({className:"logout-link",href:"javascript://",onClick:this.handleClick},"Log out"):React.DOM.a({className:"login-button button-link",href:"javascript://",onClick:this.handleClick},"Log in with Facebook");return React.DOM.div(null,a)}}),Main=React.createClass({displayName:"Main",getInitialState:function(){return{loggedIn:this.props.currentUser}},handleSessionChange:function(){this.state.loggedIn?(Parse.User.logOut(),this.setState({loggedIn:!1})):Parse.FacebookUtils.logIn("publish_actions,email",{success:function(a){a.existed()||this.createUser(a)},error:function(){console.log("User cancelled the Facebook login or did not fully authorize.")}}).then(_.bind(function(){this.setState({loggedIn:!0})},this))},createUser:function(a){var b=a.attributes.authData.facebook.access_token;$.ajax({url:"https://graph.facebook.com/v2.0/me",data:{access_token:b},success:function(b){_.each(_.keys(b),function(c){"id"!=c&&a.set(c,b[c])}),a.save()},error:function(a,b){console.log(b)}})},render:function(){return React.DOM.div({className:"wrapper"},FacebookButton({loggedIn:this.state.loggedIn,onSessionChange:this.handleSessionChange}))}});React.renderComponent(Main({currentUser:Parse.User.current()}),$("#main")[0]);
//# sourceMappingURL=flibbertigibbet.map